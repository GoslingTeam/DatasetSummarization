# Dataset Summarization

Authors: Georgy Andryushchenko, Zukhra Khadeeva

Implementation of the LLM-based solution for generating descriptive texts about datasets. The repository contains the following three summarizers:

1. KaggleMigrationSummarizer

    Produces three descriptions (collection method, dataset structure, potential uses) from dataset metadata and pieces of dataset files.

2. RegenerationSummarizer

    Produces a single paragraph from the three descriptions (collection method, dataset structure, potential uses).

3. PreviewSummarizer

    Produces a single sentence from a single paragraph.

In this project we experimented with different prompt engineering techniques and compared the results of the approaches with the reference texts generated by ChatGPT and refined by us.

## How to launch and use

### KaggleMigrationSummarizer

Python implementation of KaggleMigrationSummarizer can be found in `KaggleMigration/Summarization/kaggle_migration_summarization.py`.

Usage example:
```python
from kaggle_migration_summarization import KaggleMigrationSummarizer

summarizer = KaggleMigrationSummarizer()
json_path = os.path.join('..', 'InputExample', 'dataset-metadata.json')
zip_path = os.path.join('..', 'InputExample', 'hotel-recommendation-dataset.zip')

with open(json_path) as json_file:
    with zipfile.ZipFile(zip_path, 'r') as zip_file:
        print(summarizer.generate_descriptions(json_file, zip_file))
``` 

### RegenerationSummarizer

Python implementation of RegenerationSummarizer can be found in `Regeneration/Summarization/regeneration_summary.py`.

Usage example:
```python

if __name__ == "__main__":
    summary_generator = SummaryGenerator()

    collection_info = 'Датасет YTS movie dataset содержит информацию о фильмах и телесериалах, включая их названия, год выпуска, рейтинг IMDB, жанры, режиссеров, актёров иsimilar movies. В датасете представлено множество фильмов на английском языке, относящихся к разным жанрам: комедийные, криминальные, драматические, мюзиклы и другие. Например, в одном из файлов представлены фильмы "All In: The Family" (2020), "The Razors Edge" (1984) и "Bebes Kids" (1992).Данные были собраны неизвестным автором, и информация о сборе данных не предоставляется. Однако можно предположить, что данные были взяты из различных источников, таких как IMDb, Rotten Tomatoes и других сайтов для киноафиши, и были проанализированы с целью анализа и рекомендации фильмов. В целом, данный датасет может быть полезен для аналитиков и разработчиков систем рекомендаций в области кинематографии и телевидения.'
    structure_info = 'Датасет "YTS movie dataset" представляет собой сборник данных для анализа и системы рекомендаций фильмов. Данные содержатся в файле JSON и включают информацию о различных фильмах, таких как название, год выпуска, оценка IMDb, жанры, названия актеров и режиссеров, а также похожие фильмы. Файл разделен на два файла: yts.json и yts_2022.json. Они содержат информацию о различных фильмах, включая их характеристики и similarities.'
    usecases_info = 'Датасет YTS movie dataset - это крупное многофункциональное коллективное исследование и рекомендационная система, которое содержит данные о фильмах и их аналогичных атрибутах для изучения, оценки и подбора нового контента. Эта база данных может быть использована в различных областях, таких как аналитика и отчетность, машинное обучение и прогнозирование, поиск информации и рекомендации. Например, можно использовать этот датасет для анализа и изучения предпочтений зрителей, определения тенденций и трендов в киноиндустрии, исследования влияния различных жанров и режиссеров на оценку фильмов. Также данный датасет может быть использован для создания рекомендационных систем, которые помогут пользователям выбрать новый интересный фильм или сериал в соответствии с их вкусовыми предпочтениями.Кроме того, YTS movie dataset может быть применен для поиска информации о кинофильмах и анализа их качественных характеристик, таких как жанр, год выхода, оценка IMDb и т.д. Это особенно полезно в случае, если необходимо найти фильм с определенным набором признаков или жанров.В целом, данный датасет предоставляет широкие возможности для анализа и использования в различных сферах, от науки до бизнеса, и может быть использован как для изучения и анализа киноиндустрии, так и для создания инновационных решений и систем.'

    summary = summary_generator.generate_summary(collection_info, structure_info, usecases_info)
    print("Суммаризация: ", summary)

```

### PreviewSummarizer

Python implementation of PreviewSummarizer can be found in `Preview/preview_summarization.py`.

Usage example:
```python
from preview_summarization import PreviewSummarizer

summary = """
Датасет "Coding Questions Solved With Code Llama 70B" содержит около 20 тысяч ответов 
искусственного интеллекта на задачи по программированию, подготовленные для обучения и 
тестирования алгоритмов кода. Метод сбора данных предполагает автоматическое генерирование 
ответов, что делает его уникальным источником информации о решениях на различные языки 
программирования, включая Python. Структура данных не предоставлена, однако в данных 
содержится множество примеров кода, которые могут вызывать различные результаты при 
выполнении. Эти данные потенциально могут быть полезны для обучения и тестирования алгоритмов 
кода, а также для лучшего понимания применения языков программирования в реальных ситуациях.
"""
    
summarizer = PreviewSummarizer()
print(summarizer.generate_sentence(summary))
``` 

## Basic principles of the product

All the solutions use LLM to generate the texts. The information which is necessary to produce the text is passed to LLM in the prompt. The LLM used is LLaMA 3 70b deployed on a server of IU AES.


Here is a more detailed explanation for each of the solutions:

### KaggleMigrationSummarizer

In order to generate the three descriptions (collection method, dataset structure, potential uses) for a Kaggle dataset, the summarizer uses the same dataset prompt containing the dataset metadata and pieces of files of the dataset.

The dataset prompt includes the metadata (ID, Title, Subtitle, Description, Keywords) and pieces of files. Since the number of files could be large, we included only 4 files at most in the prompt. Also, the size of the file could be large, so we include only the first 1024 bytes of each of the files.

To generate a specific description (collection method, dataset structure, potential uses) we add a special instruction to the end of the prompt.

### RegenerationSummarizer

The summarizer takes three descriptions (collection method, dataset structure, potential uses) and combines them into a single cohesive summary. Each of the three descriptions is collected through user input(or can be read from the local machine), and these inputs are then combined into a full prompt.

The prompt includes all three descriptions, and an instruction is added to summarize them into one concise paragraph. This combined prompt is then processed to generate the final summarized paragraph.

The goal of this summarizer is to create a brief, coherent summary that integrates the key points from the collection method, dataset structure, and potential uses into a single, easy-to-read paragraph.

### PreviewSummarizer

The summarizer takes one paragraph summarizing a dataset and produces a single sentence that briefly describes and advertises a dataset. 

The paragraph from the input is forwared to the prompt to LLM with an instruction to produce a short sentence that advertises the dataset best.
