# Dataset Summarization

Authors: Georgy Andryushchenko, Zukhra Khadeeva

Implementation of the LLM-based solution for generating descriptive texts about datasets. The repository contains the following three summarizers:

1. KaggleMigrationSummarizer

    Produces three descriptions (collection method, dataset structure, potential uses) from dataset metadata and pieces of dataset files.

2. RegenerationSummarizer

    Produces a single paragraph from the three descriptions (collection method, dataset structure, potential uses).

3. PreviewSummarizer

    Produces a single sentence from a single paragraph.

In this project we experimented with different prompt engineering techniques and compared the results of the approaches with the reference texts generated by ChatGPT and refined by us.

## How to launch and use

### KaggleMigrationSummarizer

Python implementation of KaggleMigrationSummarizer can be found in `KaggleMigration/Summarization/kaggle_migration_summarization.py`.

Usage example:
```python
from kaggle_migration_summarization import KaggleMigrationSummarizer

summarizer = KaggleMigrationSummarizer()
json_path = os.path.join('..', 'InputExample', 'dataset-metadata.json')
zip_path = os.path.join('..', 'InputExample', 'hotel-recommendation-dataset.zip')

with open(json_path) as json_file:
    with zipfile.ZipFile(zip_path, 'r') as zip_file:
        print(summarizer.generate_descriptions(json_file, zip_file))
``` 

### RegenerationSummarizer

...

### PreviewSummarizer

Python implementation of PreviewSummarizer can be found in `Preview/preview_summarization.py`.

Usage example:
```python
from preview_summarization import PreviewSummarizer

summary = """
Датасет "Coding Questions Solved With Code Llama 70B" содержит около 20 тысяч ответов 
искусственного интеллекта на задачи по программированию, подготовленные для обучения и 
тестирования алгоритмов кода. Метод сбора данных предполагает автоматическое генерирование 
ответов, что делает его уникальным источником информации о решениях на различные языки 
программирования, включая Python. Структура данных не предоставлена, однако в данных 
содержится множество примеров кода, которые могут вызывать различные результаты при 
выполнении. Эти данные потенциально могут быть полезны для обучения и тестирования алгоритмов 
кода, а также для лучшего понимания применения языков программирования в реальных ситуациях.
"""
    
summarizer = PreviewSummarizer()
print(summarizer.generate_sentence(summary))
``` 

## Basic principles of the product

All the solutions use LLM to generate the texts. The information which is necessary to produce the text is passed to LLM in the prompt. The LLM used is LLaMA 3 70b deployed on a server of IU AES.


Here is a more detailed explanation for each of the solutions:

### KaggleMigrationSummarizer

In order to generate the three descriptions (collection method, dataset structure, potential uses) for a Kaggle dataset, the summarizer uses the same dataset prompt containing the dataset metadata and pieces of files of the dataset.

The dataset prompt includes the metadata (ID, Title, Subtitle, Description, Keywords) and pieces of files. Since the number of files could be large, we included only 4 files at most in the prompt. Also, the size of the file could be large, so we include only the first 1024 bytes of each of the files.

To generate a specific description (collection method, dataset structure, potential uses) we add a special instruction to the end of the prompt.

### RegenerationSummarizer

...

### PreviewSummarizer

The summarizer takes one paragraph summarizing a dataset and produces a single sentence that briefly describes and advertises a dataset. 

The paragraph from the input is forwared to the prompt to LLM with an instruction to produce a short sentence that advertises the dataset best.
